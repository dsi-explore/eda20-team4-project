---
title: "exploring_industries"
output: html_notebook
editor_options: 
  chunk_output_type: console
---


# Exploring  around different industries in the data set ad sorting to find out which industry has the highest number of jobs


```{r}
industry <- table(ds_jobs$Industry)
sorted_industry <- industry[order(-industry)]

```


We see that, Information technolody, business services and biotech are the top 3 industries considering all the regions. From the exploration around regions file, we see that NY tops the list. Find out more about industries only in NY region.

```{r}
NY %>%
  group_by(Industry) %>%
  summarize(count = n()) %>%
  arrange(desc(count))
```

Even though healthcare is not in the top 3 while considering industries providing more job opportunities, when combining it with regions and analysing for NY, we find that there are more health care jobs!! Now, that seems interesting

Proceeding further, we can see about the salary range.

# What type of data science jobs are available?

Now that we have seen which industries are hiring for jobs, let's look at how many are data science related. What I want to do here is separate non-data science jobs from data science jobs. From there, I want to separate the data science jobs by where they fall in the data science process (ex. data engineering, data analyst, data science, etc.).

## Engineering, analyst, and data scientist

```{r}
data <- grep("data", ds_jobs$Job_title, ignore.case = TRUE, value = TRUE)

engineer <- grep("engineer", data, ignore.case = TRUE, value = TRUE)
analyst <- grep("anal", data, ignore.case = TRUE, value = TRUE)
ds <- grep("scient", data, ignore.case = TRUE, value = TRUE)
```

There are 1562 jobs (26% of total jobs in ds_jobs data set) that have "data" in their title
* 553 (35% of the data jobs) have "engineer" in the title
* 342 (22% of the data jobs) have "analyst" in the title
* 634 (41% of the data jobs) have "scientist" in the title

This does not add up to be all of the jobs so I want to subtract these jobs from the data jobs. There are 87 jobs without these in their title.

Some jobs fall into multiple categories.

```{r}
data2 <- data[!data %in% engineer]
data3 <- data2[!data2 %in% analyst]
data4 <- data3[!data3 %in% ds]

sum(as.integer((engineer %in% analyst)))
```

## ML and stats jobs

Now that I have found data engineering, data analyst, and data scientist jobs, I want to see if there are any machine learning or stats jobs in the data set.

```{r}
ml <- grep("machine", ds_jobs$Job_title, ignore.case = TRUE, value = TRUE)

stats <- grep("stat", ds_jobs$Job_title, ignore.case = TRUE, value = TRUE)
```

There are 14 ML jobs within the ds_jobs data set. Some of these jobs include 'data scientist' so we can look into that for the bucketing. 

There are 26 stats jobs within the ds_jobs data set. Same problem. Someone of these jobs contain 'data scientist'/'data analyst'.

# Add variable bucketing job titles

The job titles varying so we want to bucket the job titles in larger categories. For example, 'Data Scientist' and 'Sr Data Scientist' will be bucketed into the same 'Data Scientist' category.

```{r}
ds_jobs_bucket <- ds_jobs %>%
  mutate(job_category = NA)
  
  
for (i in seq_along(ds_jobs$Job_title)) {
  if ((ds_jobs$Job_title[[i]] %in% engineer) && (is.na(ds_jobs_bucket$job_category[[i]]))) {
    ds_jobs_bucket$job_category[[i]] = "Data Engineer"
  } else if ((ds_jobs$Job_title[[i]] %in% analyst) && (is.na(ds_jobs_bucket$job_category[[i]]))) {
    ds_jobs_bucket$job_category[[i]] = "Data Analyst"
  } else if ((ds_jobs$Job_title[[i]] %in% ds) && (is.na(ds_jobs_bucket$job_category[[i]]))) {
    ds_jobs_bucket$job_category[[i]] = "Data Scientist"
  } else if ((ds_jobs$Job_title[[i]] %in% ml) && (is.na(ds_jobs_bucket$job_category[[i]]))) {
    ds_jobs_bucket$job_category[[i]] = "Machine Learning"
  } else if ((ds_jobs$Job_title[[i]] %in% stats) && (is.na(ds_jobs_bucket$job_category[[i]]))) {
    ds_jobs_bucket$job_category[[i]] = "Statistics"
  } 
}
```

Then we want to see how many NA values there are and what thejob titles of the NA values are.

```{r}
ds_jobs_bucket %>%
  group_by(job_category) %>%
  summarise(count = n())

ds_jobs_bucket %>%
  filter(is.na(job_category)) %>%
  group_by(Job_title) %>%
  summarise(count = n()) %>%
  arrange(desc(count)) %>%
  slice(1:20)
```

There are 1802 NA values in the job_category column and it looks like none of theses jobs have any relation to data science.

# Analysing the number of jobs in every category by taking the ds_jobs_bucket.So, here we have five categories Data Analyst, Data Engineer, Data Scientist, Machine Learning and Statistics. Finding out how many of these fall into different industries. In our data frame, we have 23 industries for which we can map these data science job categories.

```{R}
table(ds_jobs_bucket$Industry,ds_jobs_bucket$job_category)
```

Let's plot the above

```{R}

```


# Time series analysis

There are two columns Date_Posted and Valid_Until which denotes the time frame until which the job applications are open and denoting the recruitment time frame for candidates. On trying to plot the availabiloty of new jobs while considering the date posted, we find that it doesn't increase exponentially neither does it hits the bottom but it reaches it's peak after mid May denoting the max job availability.


```{R}
table_date_posted <- data.frame(table(ds_jobs$Date_Posted))
table_date_posted$Var1 <- as.Date(table_date_posted$Var1, format = "%Y-%m-%d") 
class(table_date_posted$Var1)
ggplot(table_date_posted, aes(x = Var1, y = Freq)) +
  geom_line() +
  labs(title = "Job availability vs Date posted",
       x = "Date",
       y = "Number of jobs")

```



```{R}
library(ggplot2)
library(scales)
ggplot(table_date_posted, aes(x = Var1, y = Freq)) +
  geom_line(color = "black", 
            size=1 ) +
  geom_smooth() +
  theme_minimal()

```
